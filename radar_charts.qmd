---
title: "Radar Charts"
date: 11-22-2025
author: Ntobeko Sosibo
toc: true
toc-location: left
toc-title: "Contents"
toc-depth: 6
format: 
  html:
    grid: 
      body-width: 1200px
    page-layout: full
    embed-resources: true
    self-contained: true
---

## 1. Existing examples from the documentation(s)  

### 1.1 Basic radar chart  

Here's the example (with minor adjustments) provided on John Coene's [ECharts4R site](https://echarts4r.john-coene.com/articles/chart_types). It depicts two series, `y` and `z`, mapped two five variables (A-E). The chart has a tooltip and a `piecewise` legend that allows you to toggle visibility for the series.  

&nbsp;  

```{r}
#| code-fold: true
#| label: basic-radar-chart
#| fig-width: 5
#| fig-height: 6


suppressPackageStartupMessages({
  library(echarts4r)
})

# example data
df <- data.frame(
  x = c("A","B","C","D","E"),
  y = c(4, 2, 5, 3, 6),
  z = c(6, 3, 4, 7, 5)
)

# generating the chart
df |>
  e_charts(x) |>
  e_radar(y, max = 7, name = "Series Y") |>
  e_radar(z, max = 7, name = "Series Z") |>
  e_tooltip(trigger = "item") |>
  e_legend()
```  

&nbsp;  

### 1.2 Cycle through with Legend  

The [AQI Radar](http://echarts.apache.org/examples/en/editor.html?c=radar-aqi) example on the ECharts site is a great example of using the legend as a method of navagating the data, cycling through the series with a single click. It looks like this is achieved by the `selectedMode: 'single'` line in the `legend: `  call:

&nbsp;

```html
legend: {
    bottom: 5,
    data: ['Beijing', 'Shanghai', 'Guangzhou'],
    itemGap: 20,
    textStyle: {
      color: '#fff',
      fontSize: 14
    },
    selectedMode: 'single'
  },
```

&nbsp;

The `selectedMode =` argument is also available in ECharts4R within thee `legend()`, but the table needs to `pivot_wider()` so that you can group by `year`.   

```{r}
#| code-fold: true
#| label: radar-chart-legend-multiple

suppressPackageStartupMessages({
  library(echarts4r)
  library(tidyr)
})
# example data
df <- data.frame(
  year = rep(2018:2022, each = 5),
  x = rep(c("A","B","C","D","E"), times = 5),
  y = c(
    4,2,5,3,6, 
    5,3,4,6,2, 
    2,6,3,5,4, 
    6,4,2,7,3, 
    3,5,6,2,4
  ),
  z = c(
    6,3,4,7,5, 
    5,6,3,4,7, 
    7,4,6,3,5, 
    4,7,5,6,3, 
    6,5,3,4,7
  )
)
# pivoting to wide table format
df_wide <- df |>
  pivot_wider(
    id_cols = x,
    names_from = year,
    values_from = c(y, z),
    names_glue = "{.value}_{year}" # more efficient method compared to mutating with case_whens 
  )


# chart: all series in one radar
df_wide |>
  e_charts(x, height = 650) |>
  # 2018
  e_radar(y_2018, name = "Y 2018", max = 7) |>
  e_radar(z_2018, name = "Z 2018", max = 7) |>
  # 2019
  e_radar(y_2019, name = "Y 2019", max = 7) |>
  e_radar(z_2019, name = "Z 2019", max = 7) |>
  # 2020
  e_radar(y_2020, name = "Y 2020", max = 7) |>
  e_radar(z_2020, name = "Z 2020", max = 7) |>
  # 2021
  e_radar(y_2021, name = "Y 2021", max = 7) |>
  e_radar(z_2021, name = "Z 2021", max = 7) |>
  # 2022
  e_radar(y_2022, name = "Y 2022", max = 7) |>
  e_radar(z_2022, name = "Z 2022", max = 7) |>
  e_legend(
    # `selected =` in e_legend to show only one year initially
    selectedMode = "multiple",  
    selected = list(
      "Y 2018" = TRUE, "Z 2018" = TRUE, # sets it so 2018 is already visible on first generation
      "Y 2019" = FALSE, "Z 2019" = FALSE,
      "Y 2020" = FALSE, "Z 2020" = FALSE,
      "Y 2021" = FALSE, "Z 2021" = FALSE,
      "Y 2022" = FALSE, "Z 2022" = FALSE
    )
  ) |>
  e_tooltip(trigger = "item")
```

&nbsp; 

The limitation at this point is that you cannot map more than one series at a time to a single "button" (in this case, to a single year). Instead, you need to map `y` and `z` to each year, creating an `e_radar()` for each one. This generates the *layers* that you can toggle on/off in whatever combination you like, negating the need to go beyond using native ECharts4R.  

&nbsp;  

### 1.3 Mapping multiple series and using a dropdown menu  

The template below contains a fleshed-out dataset of the performance of two athletes over the course of five years. I took this one a little further to include additional interavity you'd normally find in a shiny app.  

&nbsp;  

```{r}
#| code-fold: true
#| label: radar-chart-multie-serie-and-dropdown

suppressPackageStartupMessages({
  library(echarts4r)
  library(dplyr)
  library(jsonlite)
  library(htmltools)
  library(htmlwidgets)
})

# example data
df <- data.frame(
  year = rep(2018:2022, each = 5),
  metrics = rep(c("Points Scored", "Assists", "Accuracy", "Tackles", "Rebounds"), times = 5),
  rob_jackson = c(88,21,84,39,69, 59,32,46,68,28, 28,63,39,57,47, 67,44,99,76,36, 36,55,67,25,44),
  jack_robson = c(65,36,92,73,55, 54,67,36,42,74, 73,48,61,31,53, 42,79,57,6,32, 61,50,83,40,71)
)

# split data by year
dfs <- split(df, df$year)

# convert to JSON for JS
dfs_json <- toJSON(dfs, dataframe = "rows", auto_unbox = TRUE)

# dropdown & chart container
htmltools::tagList(
  tags$div(
    style = "margin-bottom: 10px; height: 10px;",
    tags$label(
      "Select Year:",
      `for` = "yearSelect",
      style = "margin-right: 8px; font-weight: bold; font-size: 14px;"
    ),
    tags$select(
      id = "yearSelect",
      tags$option(value = "2018", "2018"),
      tags$option(value = "2019", "2019"),
      tags$option(value = "2020", "2020"),
      tags$option(value = "2021", "2021"),
      tags$option(value = "2022", "2022")
    )
  ),
  
# initial radar chart
  dfs[['2018']] |>
    e_charts(metrics, height = 500,) |>
    e_radar(rob_jackson, name = "Rob Jackson") |>
    e_radar(jack_robson, name = "Jack Robson") |>
    e_legend(left = "0%", bottom = "85%") |>
    e_color(c("#1f77b4", "#ff7f0e")) |>
    e_grid(top = 50) |>
    htmlwidgets::onRender(
      jsCode = htmlwidgets::JS(
        paste0( 
          "function(el, x){",
          "  var chart = echarts.getInstanceByDom(el);",
          "  var fullData = ", dfs_json, ";",
          "  function updateChart(year){",
          "    var dat = fullData[year];",
          "    var indicators = dat.map(d => ({name: d.metrics, max: 100}));",
          "    chart.setOption({",
          "      radar:[{indicator: indicators, height: 250}],",
          "      series:[",
          "        {type:'radar', name:'Rob Jackson', data:[dat.map(d=>d.rob_jackson)], itemStyle:{color:'#1f77b4'}, lineStyle:{color:'#1f77b4'}, areaStyle:{color:'#1f77b4', opacity:0.3}},",
          "        {type:'radar', name:'Jack Robson', data:[dat.map(d=>d.jack_robson)], itemStyle:{color:'#ff7f0e'}, lineStyle:{color:'#ff7f0e'}, areaStyle:{color:'#ff7f0e', opacity:0.3}}",
          "      ],",
          "      tooltip:{",
          "        trigger:'item',",
          "        backgroundColor:'rgba(255,255,255,0.9)',",
          "        formatter:function(params){",
          "          if(!Array.isArray(params)) params=[params];",
          "          var p=params[0];",
          "          var tooltip='<div style=\"font-family: system-ui; font-size: 14px; font-weight:bold; margin-bottom:6px; color:#333;\">Player Stats: Field Metrics</div>';",
          "          var color=p.color||'#000';",
          "          tooltip += '<div style=\"font-family: system-ui; font-size: 12px; font-weight:bold; margin-bottom:6px;\">' +",
          "                     '<span style=\"display:inline-block; width:10px; height:10px; background-color:' + color + '; border-radius:3px; margin-right:6px;\"></span>' +",
          "                     p.seriesName + '</div>';",
          "          p.value.forEach(function(v,i){",
          "            var metricName=dat[i].metrics;",
          "            var displayVal=(metricName==='Accuracy')?v+'%':v;",
          "            tooltip+='<div style=\"font-family: system-ui; font-size: 12px; font-weight: normal; margin:1px 16px;\"><span style=\"color:#666;\">'+metricName+':</span> <b>'+displayVal+'</b></div>';",
          "          });",
          "          return tooltip;",
          "        }",
          "      },",
          "      graphic:[{type:'text', left:'0%', top:'5%', style:{text:'Player Legend:', fill:'#333', fontFamily:'system-ui', fontWeight:'bold', fontSize:14}}]",
          "    });",
          "  }",
          "  updateChart('2018');",
          "  document.getElementById('yearSelect').addEventListener('change', function(e){updateChart(e.target.value);});",
          "}"
        )
      )
    )
)
```

&nbsp;  

I wanted this template to have more interactivity/control without needing any kind of Shiny intervention. The final result is simple, compact, and fully self-contained. No need to connect to any servers or to pull additional data from anywhere. 

Really proud of how this one came out.  

&nbsp;  

## 2. Outro  

This was probably the most challenging template to put together (so far). Echarts4R is a fantastic library, but it's even moreso when you combine  it with HTML and JS. Adding interactivity, however, does make those two tools necessary to ensure a high degree of editing control.    

If you think something's missing or have a question give me a shout and we can figure it out together.  
